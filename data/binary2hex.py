#!/usr/bin/env python
# -*- coding: UTF-8 -*-
"""
@Project    : malware_classification
@File       : binary2hex.py
@IDE        : PyCharm
@Author     : Huang Hua
@Date       : 2021/9/6 16:08
"""

import numpy
from PIL import Image
import binascii


def get_matrix_from_bin(filename, width=512):
    with open(filename, mode='rb') as f:
        content = f.read()
    hex_str = binascii.hexlify(content)
    fh = numpy.array([int(hex_str[i:i + 2], 16) for i in range(0, len(hex_str), 2)])
    rn = len(fh) // width
    fh = numpy.reshape(fh[:rn * width], (-1, width))
    fh = numpy.uint8(fh)
    return fh


def get_matrix(filename, width=512):
    img = Image.fromarray(get_matrix_from_bin(filename, width))
    return img.resize((width, width))


if __name__ == "__main__":
    file_name = "data/30aa3fb6464aad90ec2db8be5395bb09"
    img = Image.fromarray(get_matrix_from_bin(file_name, 512))
    # img.show()
    # img.save("save/30aa3fb6464aad90ec2db8be5395bb09.png")
    print(img.size)
    a = img.resize((512, 512))
    a=numpy.array(a)
    print(a.shape)
