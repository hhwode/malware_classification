#!/usr/bin/env python
# -*- coding: UTF-8 -*-
"""
@Project    : malware_classification
@File       : analysis.py
@IDE        : PyCharm
@Author     : Huang Hua
@Date       : 2021/9/6 9:42
"""

import matplotlib.pyplot as plt
from matplotlib.pyplot import MultipleLocator
import pandas as pd
import numpy as np


def count_class(file_path):
    data = pd.read_csv(file_path, header=0)
    x = []
    y = []
    for class_id in pd.unique(data['family']):
        print(class_id, len(data[data['family'] == class_id]))
        x.append(class_id)
        y.append(len(data[data['family'] == class_id]))
    return x, y


x, y = count_class('data/train_label.csv')
# 从pyplot导入MultipleLocator类，这个类用于设置刻度间隔
plt.bar(x, y)
plt.xlabel("类别")
plt.ylabel("数量")
plt.rcParams['font.sans-serif'] = ['SimHei']  # 用来正常显示中文标签
x_major_locator = MultipleLocator(1)
# 把x轴的刻度间隔设置为1，并存在变量里
# y_major_locator=MultipleLocator(10)
# 把y轴的刻度间隔设置为10，并存在变量里
ax = plt.gca()
# ax为两条坐标轴的实例
ax.xaxis.set_major_locator(x_major_locator)
# 把x轴的主刻度设置为1的倍数
# ax.yaxis.set_major_locator(y_major_locator)
# 把y轴的主刻度设置为10的倍数
plt.xlim(-0.5, 10)
index = np.arange(len(y))
for a, b in zip(x, y):
    plt.text(a, b, '%d' % b, ha='center', va='bottom', fontsize=7)
plt.show()
plt.savefig(fname="class.png")
